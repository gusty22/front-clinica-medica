<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClinicaPi - Crie sua Conta (Bootstrap 5)</title>
    <meta name="description"
        content="Crie sua conta na ClinicaPi e escolha o plano ideal para sua clínica. Comece hoje mesmo.">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <script src="https://unpkg.com/feather-icons"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        /* Paleta de cores da Homepage */
        :root {
            --bs-primary: #0EA5E9;
            --bs-primary-rgb: 14, 165, 233;
            --bs-primary-dark: #0369A1;
            --bs-primary-light: #E0F2FE;
            --bs-secondary: #64748B;
            --bs-dark: #1E293B;
            --bs-light: #F8FAFC;
            --bs-warning: #F59E0B;
            --bs-body-font-family: 'Inter', sans-serif;
            --bs-body-color: var(--bs-secondary);
            --bs-border-color: #e2e8f0;
            --bs-border-radius-lg: 0.5rem;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--bs-body-font-family);
            color: var(--bs-body-color);
            background-color: var(--bs-light);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            position: relative;
        }

        /* Estilos do Header (copiados da homepage.html) */
        .navbar-nav .nav-link {
            color: #6c757d;
            border-bottom: 2px solid transparent;
            transition: border-color 0.3s ease-in-out, color 0.3s ease-in-out;
        }
        .navbar-nav .nav-link.active,
        .navbar-nav .nav-link:hover {
            color: var(--bs-primary-dark);
            border-bottom-color: var(--bs-primary);
        }

        /* Botões */
        .btn-primary {
            background-color: var(--bs-primary);
            border-color: var(--bs-primary);
        }
        .btn-primary:hover {
            background-color: var(--bs-primary-dark);
            border-color: var(--bs-primary-dark);
        }
        .btn-outline-primary {
            color: var(--bs-primary);
            border-color: var(--bs-primary);
        }
        .btn-outline-primary:hover {
            background-color: var(--bs-primary-light);
            color: var(--bs-primary-dark);
            border-color: var(--bs-primary);
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--bs-primary);
            box-shadow: 0 0 0 0.25rem rgba(var(--bs-primary-rgb), 0.1);
        }
        .form-check-input:checked {
            background-color: var(--bs-primary);
            border-color: var(--bs-primary);
        }
        .form-check-input:focus {
            border-color: var(--bs-primary);
            box-shadow: 0 0 0 0.25rem rgba(var(--bs-primary-rgb), 0.1);
        }

        /* Estilo dos Cards de Plano */
        .plan-card {
            border: 1px solid var(--bs-border-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }
        .plan-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1) !important;
        }
        .plan-card-popular {
            border-width: 2px;
            transform: scale(1.03);
            z-index: 10;
        }
        .plan-card .list-unstyled .feather {
            width: 16px;
            color: var(--bs-primary);
        }
        
        .feather-sm { width: 1rem; height: 1rem; }

        /* Estilo para Abas de Pagamento */
        .nav-pills .nav-link {
            color: var(--bs-dark);
        }
        .nav-pills .nav-link.active {
            background-color: var(--bs-primary-light);
            color: var(--bs-primary-dark);
            font-weight: 500;
        }
        
        /* Placeholder reCAPTCHA */
        .recaptcha-placeholder {
            background-color: #f9f9f9;
            border: 1px solid #d3d3d3;
            border-radius: 4px;
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
    </style>
</head>

<body>

    <header id="mainNavbar" class="navbar navbar-expand-lg bg-white shadow-sm sticky-top">
        <nav class="container-xl">
            <a class="navbar-brand d-flex align-items-center gap-2" href="index.html"
                style="color: var(--bs-primary-dark); font-weight: 700; font-size: 1.25rem;">
                <i data-feather="activity" style="color: var(--bs-primary);"></i>
                <span>ClinicaPi</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mobileMenu"
                aria-controls="mobileMenu" aria-expanded="false" aria-label="Abrir menu principal">
                <i data-feather="menu"></i>
            </button>
            <div class="collapse navbar-collapse" id="mobileMenu">
                <ul class="navbar-nav ms-auto mb-2 mb-lg-0 d-none d-lg-flex" style="gap: 1.5rem;">
                    <li class="nav-item"><a class="nav-link px-1 pt-1 pb-0" href="index.html#hero">Início</a></li>
                    <li class="nav-item"><a class="nav-link px-1 pt-1 pb-0" href="index.html#about">Sobre</a></li>
                    <li class="nav-item"><a class="nav-link px-1 pt-1 pb-0" href="index.html#features">Funcionalidades</a></li>
                    <li class="nav-item"><a class="nav-link px-1 pt-1 pb-0" href="index.html#plans">Planos</a></li>
                    <li class="nav-item"><a class="nav-link px-1 pt-1 pb-0" href="index.html#contact">Fale Conosco</a></li>
                </ul>
                <div class="ms-lg-4 d-none d-lg-block">
                    <a href="login.html" class="btn btn-primary text-white px-4 py-2">
                        Entrar no ClinicaPi
                    </a>
                </div>
            </div>
        </nav>
    </header>

    <main class="py-5"> <div class="container" style="max-width: 900px;">
            
            <form id="cadastroForm">

                <div id="step-1">
                    <div class="text-center mb-4">
                        <h1 class="h2 fw-bold text-dark">Crie sua conta</h1>
                        <p class="text-secondary">Preencha seus dados para iniciar o cadastro.</p>
                    </div>

                    <div class="card shadow-sm border-0 rounded-4">
                        <div class="card-body p-4 p-md-5">
                            <h2 class="h5 fw-semibold text-dark mb-3">Dados Pessoais e da Clínica</h2>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="nome" class="form-label small">Nome Completo</label>
                                    <input type="text" class="form-control" id="nome" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="nome_clinica" class="form-label small">Nome da Clínica (Opcional)</label>
                                    <input type="text" class="form-control" id="nome_clinica">
                                </div>
                                <div class="col-md-6">
                                    <label for="email" class="form-label small">E-mail</label>
                                    <input type="email" class="form-control" id="email" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="contato" class="form-label small">Telefone / WhatsApp</label>
                                    <input type="tel" class="form-control" id="contato" placeholder="(00) 00000-0000" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="senha" class="form-label small">Crie uma Senha</label>
                                    <div class="input-group">
                                        <input type="password" class="form-control" id="senha" required>
                                        <button class="btn btn-outline-secondary" type="button" id="toggleSenha"><i data-feather="eye"></i></button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label for="confirma_senha" class="form-label small">Confirme a Senha</label>
                                    <input type="password" class="form-control" id="confirma_senha" required>
                                </div>

                                <div class="col-12 mt-4">
                                    <div class="recaptcha-placeholder small">
                                        <div class="d-flex align-items-center gap-2">
                                            <input class="form-check-input" type="checkbox" checked disabled>
                                            <span>Não sou um robô</span>
                                        </div>
                                        <span class="text-muted" style="font-size: 0.7rem;">reCAPTCHA</span>
                                    </div>
                                </div>

                                <div class="col-12 mt-3">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" value="" id="termos" required>
                                        <label class="form-check-label small text-secondary" for="termos">
                                            Eu li e concordo com os <a href="#" class="text-primary">Termos de Uso</a> e a
                                            <a href="#" class="text-primary">Política de Privacidade</a>.
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="text-end mt-4">
                                <button type="button" class="btn btn-primary btn-lg" id="btn-step1-next">Continuar</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="step-2" class="d-none">
                    <div class="text-center mb-4">
                        <h1 class="h2 fw-bold text-dark">Escolha seu Plano</h1>
                        <p class="text-secondary">Selecione o plano que melhor se adapta à sua clínica.</p>
                    </div>

                    <div class="row g-4 justify-content-center">
                        <div class="col-lg-4">
                            <div class="card plan-card h-100 d-flex flex-column shadow-sm border-light-subtle p-4" onclick="selectPlan('Básico', 'R$ 99/mês')">
                                <div class="card-body d-flex flex-column">
                                    <h3 class="fs-5 fw-semibold text-dark mb-2">Básico</h3>
                                    <p class="small text-secondary mb-4">Ideal para consultórios individuais.</p>
                                    <div class="my-3">
                                        <span class="display-5 fw-bolder text-dark">R$ 99</span>
                                        <span class="text-secondary">/mês</span>
                                    </div>
                                    <ul class="list-unstyled text-start small text-secondary flex-grow-1 mb-4">
                                        <li class="d-flex align-items-center mb-2"><i data-feather="check" class="me-2"></i>Gestão de Pacientes</li>
                                        <li class="d-flex align-items-center mb-2"><i data-feather="check" class="me-2"></i>Agenda Médica</li>
                                        <li class="d-flex align-items-center mb-2"><i data-feather="check" class="me-2"></i>Prontuário Eletrônico</li>
                                    </ul>
                                    <button type="button" class="btn btn-outline-primary mt-auto w-100">Selecionar Plano</button>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div class="card plan-card plan-card-popular h-100 d-flex flex-column shadow-lg border-primary p-4 position-relative" onclick="selectPlan('Profissional', 'R$ 199/mês')">
                                <span class="badge bg-warning text-dark position-absolute top-0 end-0 translate-middle-y me-n2 rounded-pill px-3 py-1 small fw-semibold" style="font-size: 0.75rem;">
                                    7 DIAS GRÁTIS
                                </span>
                                <div class="card-body d-flex flex-column">
                                    <h3 class="fs-5 fw-semibold text-dark mb-2">Profissional</h3>
                                    <p class="small text-secondary mb-4">Completo para clínicas em crescimento.</p>
                                    <div class="my-3">
                                        <span class="display-5 fw-bolder text-dark">R$ 199</span>
                                        <span class="text-secondary">/mês</span>
                                    </div>
                                    <ul class="list-unstyled text-start small text-secondary flex-grow-1 mb-4">
                                        <li class="d-flex align-items-center mb-2"><i data-feather="check" class="me-2"></i>Todos os recursos do Básico</li>
                                        <li class="d-flex align-items-center mb-2"><i data-feather="check" class="me-2"></i>Controle Financeiro Completo</li>
                                        <li class="d-flex align-items-center mb-2"><i data-feather="check" class="me-2"></i>Emissão de Notas Fiscais</li>
                                        <li class="d-flex align-items-center mb-2"><i data-feather="check" class="me-2"></i>Relatórios Gerenciais</li>
                                    </ul>
                                    <button type="button" class="btn btn-primary shadow-sm mt-auto w-100">Selecionar Plano</button>
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-4">
                            <div class="card plan-card h-100 d-flex flex-column shadow-sm border-light-subtle p-4" onclick="selectPlan('Enterprise', 'Sob Consulta')">
                                <div class="card-body d-flex flex-column">
                                    <h3 class="fs-5 fw-semibold text-dark mb-2">Enterprise</h3>
                                    <p class="small text-secondary mb-4">Para clínicas com necessidades avançadas.</p>
                                    <div class="my-3">
                                        <span class="display-6 fw-bolder text-dark">Sob Consulta</span>
                                    </div>
                                    <ul class="list-unstyled text-start small text-secondary flex-grow-1 mb-4">
                                        <li class="d-flex align-items-center mb-2"><i data-feather="check" class="me-2"></i>Todos os recursos do Profissional</li>
                                        <li class="d-flex align-items-center mb-2"><i data-feather="check" class="me-2"></i>Múltiplos Usuários Avançado</li>
                                        <li class="d-flex align-items-center mb-2"><i data-feather="check" class="me-2"></i>Integrações Personalizadas</li>
                                    </ul>
                                    <button type="button" class="btn btn-outline-primary mt-auto w-100">Solicitar Orçamento</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="text-center mt-4">
                         <a href="#" class="btn btn-link text-secondary" id="btn-step2-prev">
                            <i data-feather="arrow-left" class="feather-sm"></i> Voltar (Etapa 1)
                        </a>
                    </div>
                </div>

                <div id="step-3" class="d-none">
                     <div class="text-center mb-4">
                        <h1 class="h2 fw-bold text-dark">Finalizar Cadastro</h1>
                        <p class="text-secondary">Revise seu plano e informe os dados de pagamento.</p>
                    </div>
                    
                    <div class="row g-4">
                        <div class="col-lg-7">
                            <div class="card shadow-sm border-0 rounded-4">
                                <div class="card-body p-4 p-md-5">
                                    <h3 class="h5 fw-semibold text-dark mb-3">Método de Pagamento</h3>
                                    
                                    <ul class="nav nav-pills nav-fill mb-4" id="paymentTab" role="tablist">
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link active" id="cartao-tab" data-bs-toggle="tab" data-bs-target="#cartao-pane" type="button" role="tab" aria-selected="true">
                                                <i data-feather="credit-card" class="feather-sm me-1"></i> Cartão de Crédito
                                            </button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="pix-tab" data-bs-toggle="tab" data-bs-target="#pix-pane" type="button" role="tab" aria-selected="false">
                                                <i data-feather="send" class="feather-sm me-1"></i> PIX
                                            </button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="boleto-tab" data-bs-toggle="tab" data-bs-target="#boleto-pane" type="button" role="tab" aria-selected="false">
                                                <i data-feather="file-text" class="feather-sm me-1"></i> Boleto
                                            </button>
                                        </li>
                                    </ul>
                                    
                                    <div class="tab-content" id="paymentTabContent">
                                        <div class="tab-pane fade show active" id="cartao-pane" role="tabpanel" aria-labelledby="cartao-tab" tabindex="0">
                                            <div class="row g-3">
                                                <div class="col-12">
                                                    <label for="cartao-nome" class="form-label small">Nome no Cartão</label>
                                                    <input type="text" id="cartao-nome" class="form-control" placeholder="Como está escrito no cartão" required>
                                                </div>
                                                <div class="col-12">
                                                    <label for="cartao-num" class="form-label small">Número do Cartão</label>
                                                    <input type="text" id="cartao-num" class="form-control" placeholder="0000 0000 0000 0000" required>
                                                </div>
                                                <div class="col-md-6">
                                                    <label for="cartao-validade" class="form-label small">Validade</label>
                                                    <input type="text" id="cartao-validade" class="form-control" placeholder="MM/AA" required>
                                                </div>
                                                <div class="col-md-6">
                                                    <label for="cartao-cvv" class="form-label small">CVV</label>
                                                    <input type="text" id="cartao-cvv" class="form-control" placeholder="123" required>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tab-pane fade text-center" id="pix-pane" role="tabpanel" aria-labelledby="pix-tab" tabindex="0">
                                            <p class="text-secondary small">Um código PIX Copia e Cola será gerado após a confirmação. O pagamento deve ser feito em até 10 minutos.</p>
                                            <img src="https://via.placeholder.com/200x200/FFFFFF/1E293B?text=QR+Code+PIX" alt="QR Code PIX" class="img-fluid rounded-3 border">
                                        </div>
                                        <div class="tab-pane fade" id="boleto-pane" role="tabpanel" aria-labelledby="boleto-tab" tabindex="0">
                                            <p class="text-secondary small text-center">O boleto será gerado e enviado para o seu e-mail. O prazo de compensação é de até 3 dias úteis.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-lg-5">
                            <div class="card shadow-sm border-0 rounded-4">
                                <div class="card-header bg-light border-0 p-4">
                                    <h3 class="h5 fw-semibold text-dark mb-0">Resumo do Pedido</h3>
                                </div>
                                <div class="card-body p-4">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span class="text-secondary">Plano:</span>
                                        <span class="fw-medium text-dark" id="plano-nome">Profissional</span>
                                    </div>
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <span class="text-secondary">Valor:</span>
                                        <span class="fw-medium text-dark" id="plano-valor">R$ 199/mês</span>
                                    </div>
                                    <div class="alert alert-success small p-2" role="alert">
                                        <i data-feather="check" class="feather-sm"></i> <strong>7 dias grátis</strong> aplicados!
                                    </div>
                                    <ul class="list-unstyled d-flex flex-column gap-2 mb-0 small text-secondary mt-3">
                                        <li class="d-flex align-items-center gap-2"><i data-feather="check" class="text-primary feather-sm"></i> Acesso completo ao sistema.</li>
                                        <li class="d-flex align-items-center gap-2"><i data-feather="check" class="text-primary feather-sm"></i> Suporte prioritário.</li>
                                        <li class="d-flex align-items-center gap-2"><i data-feather="check" class="text-primary feather-sm"></i> Cancele quando quiser.</li>
                                    </ul>
                                </div>
                                <div class="card-footer p-4 border-0">
                                    <button type="submit" class="btn btn-primary btn-lg w-100" id="btn-submit-form">
                                        <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                                        <span class="button-text">Concluir Cadastro e Ativar</span>
                                    </button>
                                     <div class="text-center mt-3">
                                        <a href="#" class="btn btn-link text-secondary small" id="btn-step3-prev">
                                            <i data-feather="arrow-left" class="feather-sm"></i> Voltar (Planos)
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="step-4" class="d-none">
                    <div class="card shadow-sm border-0 rounded-4" style="max-width: 500px; margin: auto;">
                        <div class="card-body p-4 p-md-5 text-center">
                            <div class="p-3 rounded-circle bg-primary-subtle text-primary d-inline-flex mb-3">
                                <i data-feather="check-circle" style="width: 40px; height: 40px;"></i>
                            </div>
                            <h2 class="h3 fw-bold text-dark mb-2">Cadastro Concluído!</h2>
                            <p class="text-secondary mb-4">
                                Sua conta foi criada e seu plano está ativo. Seja bem-vindo à ClinicaPi!
                            </p>
                            <a href="login.html" class="btn btn-primary btn-lg w-100">
                                Acessar minha conta
                            </a>
                        </div>
                    </div>
                </div>

            </form> </div>
    </main>

    <footer class="bg-dark text-white-50">
        <div class="container-xl py-4">
            <div
                class="d-flex flex-column flex-md-row justify-content-between align-items-center gap-3 text-center text-md-start">
                <div>
                    <a class="d-flex justify-content-center justify-content-md-start align-items-center gap-2 text-white text-decoration-none fw-bold fs-5 mb-2"
                        href="index.html">
                        <i data-feather="activity" style="color: var(--bs-primary);"></i>
                        <span>ClinicaPi</span>
                    </a>
                    <p class="small mb-0">&copy; 2025 ClinicaPi. Todos os direitos reservados.</p>
                </div>
                <div class="d-flex flex-wrap justify-content-center justify-content-md-end gap-3 small">
                    <a href="index.html#hero" class="nav-link text-white-50 px-0">Início</a>
                    <a href="index.html#features" class="nav-link text-white-50 px-0">Funcionalidades</a>
                    <a href="index.html#plans" class="nav-link text-white-50 px-0">Planos</a>
                    <a href="index.html#contact" class="nav-link text-white-50 px-0">Fale Conosco</a>
                    <a href="#" class="nav-link text-white-50 px-0">Política de Privacidade</a>
                </div>
            </div>
        </div>
    </footer>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <script>
        // Inicializa Feather Icons
        feather.replace();

        // Lógica do Navbar Scroll (da homepage)
        const navbar = document.getElementById('mainNavbar');
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                navbar.classList.add('shadow-sm');
            } else {
                navbar.classList.remove('shadow-sm');
            }
        });
        
        // --- LÓGICA DE CADASTRO MULTI-STEP ---
        
        document.addEventListener('DOMContentLoaded', function() {
            
            const step1 = document.getElementById('step-1');
            const step2 = document.getElementById('step-2');
            const step3 = document.getElementById('step-3');
            const step4 = document.getElementById('step-4');

            const btnStep1Next = document.getElementById('btn-step1-next');
            const btnStep2Prev = document.getElementById('btn-step2-prev');
            const btnStep3Prev = document.getElementById('btn-step3-prev');
            
            const form = document.getElementById('cadastroForm');
            const submitButton = document.getElementById('btn-submit-form');
            
            // ### SCRIPT ADICIONADO PARA LER URL ###
            const planDefinitions = {
                'basico': { nome: 'Básico', valor: 'R$ 99/mês' },
                'profissional': { nome: 'Profissional', valor: 'R$ 199/mês' },
                'enterprise': { nome: 'Enterprise', valor: 'Sob Consulta' }
            };

            const urlParams = new URLSearchParams(window.location.search);
            const planoPreSelecionado = urlParams.get('plano');

            if (planoPreSelecionado && planDefinitions[planoPreSelecionado]) {
                // Armazena o plano para usar depois do cadastro
                sessionStorage.setItem('planoSelecionado', planoPreSelecionado);
            } else {
                // Garante que não há lixo de um clique anterior
                sessionStorage.removeItem('planoSelecionado');
            }
            // ### FIM DO SCRIPT DE LEITURA DE URL ###


            // --- Navegação Etapa 1 -> 2 (ou 3) ---
            btnStep1Next.addEventListener('click', () => {
                if (form.checkValidity()) {
                    
                    const planoSalvo = sessionStorage.getItem('planoSelecionado');
                    
                    if (planoSalvo && planDefinitions[planoSalvo]) {
                        // ### PULA DIRETO PARA ETAPA 3 ###
                        const plano = planDefinitions[planoSalvo];
                        document.getElementById('plano-nome').textContent = plano.nome;
                        document.getElementById('plano-valor').textContent = plano.valor;
                        
                        step1.classList.add('d-none');
                        step3.classList.remove('d-none');
                        sessionStorage.removeItem('planoSelecionado'); // Limpa
                    } else {
                        // ### VAI PARA ETAPA 2 (NORMAL) ###
                        step1.classList.add('d-none');
                        step2.classList.remove('d-none');
                    }
                    window.scrollTo(0, 0); // Rola para o topo
                } else {
                    form.reportValidity(); // Mostra erros de validação
                }
            });

            // --- Navegação Etapa 2 -> 1 (Voltar) ---
            btnStep2Prev.addEventListener('click', (e) => {
                e.preventDefault();
                step2.classList.add('d-none');
                step1.classList.remove('d-none');
                window.scrollTo(0, 0);
            });
            
            // --- Navegação Etapa 3 -> 2 (Voltar) ---
            // Modificado: só volta para Etapa 2 se NENHUM plano foi passado na URL
            btnStep3Prev.addEventListener('click', (e) => {
                e.preventDefault();
                step3.classList.add('d-none');
                // Se um plano foi pré-selecionado, voltar leva para Etapa 1
                if (urlParams.get('plano')) { 
                    step1.classList.remove('d-none');
                } else {
                    step2.classList.remove('d-none');
                }
                window.scrollTo(0, 0);
            });

            // --- Ação: Selecionar Plano (Etapa 2 -> 3) ---
            window.selectPlan = function(nome, valor) {
                document.getElementById('plano-nome').textContent = nome;
                document.getElementById('plano-valor').textContent = valor;
                
                step2.classList.add('d-none');
                step3.classList.remove('d-none');
                window.scrollTo(0, 0);
            }

            // --- Lógica da Etapa 3 (Pagamento) ---
            form.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const cartaoTab = document.getElementById('cartao-pane');
                let formValido = true;
                
                // Valida o cartão apenas se a aba estiver ativa
                if (cartaoTab.classList.contains('show')) {
                    const camposCartao = ['cartao-nome', 'cartao-num', 'cartao-validade', 'cartao-cvv'];
                    for (const id of camposCartao) {
                        const campo = document.getElementById(id);
                        if (!campo.value) {
                            campo.classList.add('is-invalid'); // Mostra erro do Bootstrap
                            formValido = false;
                        } else {
                            campo.classList.remove('is-invalid');
                        }
                    }
                }

                if (!formValido) {
                     alert('Por favor, preencha todos os dados do cartão.');
                     return;
                }
                
                const btnText = submitButton.querySelector('.button-text');
                const btnSpinner = submitButton.querySelector('.spinner-border');
                btnText.textContent = 'Processando...';
                btnSpinner.classList.remove('d-none');
                submitButton.disabled = true;

                setTimeout(() => {
                    step3.classList.add('d-none');
                    step4.classList.remove('d-none');
                    window.scrollTo(0, 0);
                }, 1500); 
            });

            // --- Script de Mostrar/Ocultar Senha (Etapa 1) ---
            const toggleSenha = document.querySelector('#toggleSenha');
            const senha = document.querySelector('#senha');
            const eyeIcon = toggleSenha.querySelector('i');

            toggleSenha.addEventListener('click', function (e) {
                const type = senha.getAttribute('type') === 'password' ? 'text' : 'password';
                senha.setAttribute('type', type);
                eyeIcon.setAttribute('data-feather', (type === 'password') ? 'eye' : 'eye-off');
                feather.replace();
            });

        });
    </script>

</body>

</html>